---
title: "Anàlisi de dades òmiques (M0 - 157)"
subtitle: "Primera prova d'avaluació contínua"
author: "MIQUEL SASTRE BELIO"
date: "`r Sys.Date()`"
output: html_document
---

# Resum

# Objectius

Els objectius generals d'aquesta primera prova d'avaluació continuada són reforçar el coneixement sobre les tecnologies òmiques, l'ús de _Bioconductor_ i les classes que s'utilitzen per emmagatzemar dades òmiques, Git com a eina de control de versions i les eines estadístiques d'exploració de dades. Així, como últim objectiu, es té planificar i exectuar una versió simplificada del procés d'anàlisi de dades òmiques, alhora que practicar amb algunes eines i mètodes que s'han treballat durant el primer repte.


# Mètodes

S'ha seleccionat el data-set corresponent a l'estudi _Diet modulates the protective effects of dimethyl fumarate mediated by the immunometabolic neutrophil receptor HCA2 - Metabolomics_ (Study ID ST003156). És un estudi recent i que té com a punt central de la seva hipòtesi la dieta. Concretament, la hipòtesi de l'estudi es basa en que la dieta pot ser l'element o factor clau sobre els pacients amb esclerosis múltiple (EM) que no es beneficien del profàrmac dimetilfumarato (DMF), un dels agents més utilitzats en aquesta malaltia.

Totes les dades s'han obtingut de l'arxiu `ST003156_AN005178.txt`, el qual conté la descripció de l'estudi, les metadades, així com les dades crues. A partir d'aquest arxiu, es crearà l'objecte `SummarizedExperiment` i es farà una anàlisi exploratòria de les dades.

Per a elaborar l'anàlisi s'ha utilitzat el programa RStudio `r version$version.string`, així com el programa Microsoft Excel.

# Resultats

```{r}
library(BiocManager)
library(SummarizedExperiment)
```

```{r}
lines <- readLines("ST003156_AN005178.txt")
lines[1:20]
# Ref.: https://support.bioconductor.org/p/9151215/
```
```{r}
metadata <- list(
  Study_ID = "ST003156",
  Study_Title = "Diet modulates the protective effects of dimethyl fumarate mediated by the immunometabolic neutrophil receptor HCA2",
  Project_type = "Metabolomics",
  Porject_Summary = "Monomethyl fumarate (MMF) and its prodrug dimethyl fumarate (DMF) are currently the most widely used agents for the treatment of multiple sclerosis (MS). However, not all patients benefit from DMF. We hypothesized that the variable response of patients may be due to their diet. In support of this hypothesis,	mice subjected to experimental autoimmune encephalomyelitis (EAE), a model of	MS, did not benefit from DMF treatment when fed a lauric acid-rich (LA) diet, in contrast to normal chow (NC) or, more so, a high-fiber (HFb) diet. DMF lacked efficacy in the LA diet fed group despite similar resorption and preserved 	effects on plasma lipids.",
  Institute = "University of Luebeck",
  Department = "Bioanalytic Core Facility",
  Last_Name = "Inderhees",
  First_Name = "Julica",
  email = "julica.inderhees@uni-luebeck.de"
  )

counts  <- read.csv2(file = "counts.csv", row.names = 1)
colData <- read.csv(file = "colData.csv", sep = ";",
                    col.names = c("Sample Source", "Diet", "Treatment"))

limpiar_puntos <- function(x) {
  
  if (is.character(x)) {
    
    partes <- unlist(strsplit(x, "\\."))
    
    if (length(partes) > 1) {
      
      return(paste0(paste(partes[-length(partes)], collapse = ""), ".",
                    partes[length(partes)]))
    }
    
  }
  
  return(x)
  
}

for (i in 1: nrow(counts)){
  
  for (j in 1:ncol(counts)){
    
    counts[i,j] <- limpiar_puntos(counts[i,j])
  }
}

counts[] <- lapply(counts, as.numeric)

colnames(counts)

rownames(colData) <- colnames(counts)

sumexp <- SummarizedExperiment(assays = list(counts=counts),
                     colData = colData,
                     metadata = list(metadata=metadata))

colData(sumexp)
metadata(sumexp)
head(assay(sumexp))[1:5,1:5]
```


# Discussió

# Conclusions

# Referències

https://www.sthda.com/english/wiki/expressionset-and-summarizedexperiment
https://rpubs.com/jrgonzalezISGlobal/omicBioC

